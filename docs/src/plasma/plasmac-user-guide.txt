[[cha:plasmac-user-guide]]

= Guía del usuario de PlasmaC
:toc:
:figure-caption!:

== Licencia

PlasmaC y todo su software relacionado se lanza bajo GPLv2.

== Introducción

PlasmaC es una configuración LinuxCNC para corte por plasma que incorpora el componente PlasmaC HAL con configuraciones GUI para <<cha:axis-gui, Axis>> y <<cha:gmoccapy, Gmoccapy>>. Debe ejecutarse en cualquier hardware que sea compatible con LinuxCNC siempre que haya suficientes pines de E / S.

Si es un usuario nuevo, puede valer la pena leer el documento <<cha:plasma-primer,Introducción al corte por plasma>>, que es una introducción genérica al corte por plasma CNC.

PlasmaC utiliza uno de entre tres modos de operación diferentes.

[width="100%",cols="4,16"]
|===
|*Modo*|*Descripción*
|0|Utilizar entrada de voltaje de arco para calcular el voltaje de arco y arco OK
|1|Usar entrada de voltaje de arco externo para calcular el voltaje de arco +
   Usar un arco OK externo para Arc OK
|2|Usar el arco OK externo para Arc OK +
   Usar arriba / abajo externo para THC
|===

Para una funcionalidad completa, Plasmac requiere LinuxCNC v2.9 (el master actual) o posterior. Funcionará en LinuxCNC v2.8 con la función <<paused-motion,movimiento en pausa>> no disponible.

No se requiere movimiento del eje Z en G-Code, las configuraciones estándar de PlasmaC comentarán cualquier comando Z durante la carga del programa.

Para un uso confiable de PlasmaC, usted *NO* debe usar ningun offset del eje Z que no sean los offsets del sistema de coordenadas (G54 -G59.3).

Normalmente, es mejor tocar el eje Z hasta aproximadamente la parte superior de su material y luego llevar el eje Z a casi la parte superior del recorrido antes de comenzar sus cortes.

== Requisitos de E / S

Esta sección solo abarca la E / S requerida para PlasmaC; requisitos de la máquina base, como interruptores de límite, interruptores de inicio, etc., son añadidos.

[width="100%",cols="4,2,14"]
|===
|*Nombre*|*Modos*|*Descripción*
|Voltaje de arco|0,1|Entrada analógica para leer el voltaje de arco +
                     Normalmente conectado a una salida de velocidad de un codificador
|Interruptor flotante|0,1,2|Entrada digital. Opcional, ver abajo +
                            Conectado al interruptor en la cabeza flotante +
                            Si no usa una sonda óhmica, este es el sensor de sonda principal +
                            Si usa una sonda óhmica, este es el sensor de retroceso de la sonda 
|Sonda óhmica|0,1,2|Entrada digital. Opcional, ver abajo +
                   Conectado a la salida de la sonda +
                   Si se usa, este es el sensor de sonda principal
|Ohmic Probe Enable|0,1,2|Salida digital. Solo se requiere si se usa un sondeo óhmico +
                          Conectado a la sonda que habilita la entrada +
                          Este pin se usa para armar la sonda óhmica
|Interruptor separador|0,1,2|Entrada digital. Opcional, ver abajo +
                             Conectado al interruptor de ruptura de la antorcha +
                             Detecta si la antorcha se ha desprendido de su cuna
|Antorcha encendida|0,1,2|Salida digital +
                          Conectado a la antorcha en la entrada de la fuente de alimentación de plasma
|Mover hacia arriba|2|Entrada digital +
                      Conectado a la salida ascendente del control externo de THC
|Mover hacia abajo|2|Entrada digital +
                     Conectado a la salida baja del control externo de THC
|Armado de grabador|0,1,2|Salida digital +
                         Conectado al circuito de armado de aire
|Inicio de escritura|0,1,2|Salida digital +
                           Conectado al circuito de arranque de aire
|===

Solo se requiere uno de entre 'interruptor flotante' o 'sonda óhmica'. Si se usan ambos, entonces el 'interruptor flotante' será de retroceso si no se detecta la 'sonda óhmica'.

Si se utiliza la 'sonda óhmica', se requiere 'habilitar la sonda óhmica'.

El 'interruptor de ruptura' no es obligatorio porque el 'interruptor flotante' se trata de la misma manera que un interruptor de ruptura cuando no se está sondeando. Si fueran dos interruptores separados, se podrían combinar y conectar como un 'interruptor flotante'

NOTA: El requisito mínimo de E / S para una configuración de PlasmaC es la entrada de 'voltaje de arco', la entrada de 'interruptor flotante' y la salida de 'antorcha encendida'. En este caso, PlasmaC trata el interruptor flotante como un interruptor de retroceso cuando no está sondeando.

IMPORTANTE: Estos pines se ingresarán más tarde en el Configurador, *NO*  deben utilizarse en el archivo .hal de su máquina base.

== Instalación

=== Obtener LinuxCNC con los complementos de PlasmaC

El requisito mínimo para PlasmaC es LinuxCNC v2.8, aunque esta versión NO admite la función <<paused-motion,movimiento en pausa>>.

LinuxCNC v2.9 o posterior proporciona una funcionalidad completa y es la opción recomendada.

=== Si no tiene Linux instalado

Descargue una imagen ISO de una de las siguientes opciones y escríbala en un dispositivo de arranque:

* RTPREEMPT - http://www.linuxcnc.org/testing-stretch-rtpreempt/ +
Para una máquina que usa hardware de Mesa Electronics, esto también se puede usar para una máquina que usa un puerto paralelo y se recomienda para la mayoría de las máquinas modernas.

* RTAI - http://www.linuxcnc.org/iso/linuxcnc-2.7.14-wheezy.iso +
Para una máquina que usa el puerto paralelo.

Luego, inicie desde el dispositivo y siga las indicaciones.

Esto le dará una máquina con la rama estable actual (v2.7) de LinuxCNC, vaya a la siguiente sección y siga el tipo de instalación que desea. Para la mayoría de los usuarios que no realizarán ningún desarrollo LinuxCNC, se recomienda 'Buildbot'  

NOTA: Es posible instalar y ejecutar LinuxCNC en una variedad de distribuciones de Linux, pero esto está fuera del alcance de la Guía del usuario de Plasmac. Si desea seguir este camino, deberá instalar su distribución de Linux preferida y luego instalar LinuxCNC v2.9 o posterior (o LinuxCNC v2.8 si no necesita ejecución inversa), entonces puede abrir LinuxCNC y continuar con <<sec:testing-linuxcnc,Prueba de instalación de LinuxCNC>>

Todo el desarrollo de PlasmaC se ha realizado en una instalación Stretch ISO.

=== Si tiene LinuxCNC v2.7

Luego puede elegir entre:

* <<buildbot-install,una instalación de Buildbot>> LinuxCNC Buildbot proporciona paquetes precompilados que pueden ser instalados por un administrador de paquetes.
* <<rip-install,una instalación Run In Place>>. Las compilaciones de RIP se compilan en su computadora y normalmente se usan si desea realizar algún trabajo de desarrollo.

[[buildbot-install]]

.Instalación de Buildbot

Para obtener más información sobre Buildbot LinuxCNC, consulte http://buildbot.linuxcnc.org/[LinuxCNC buildbot]

Para usar los paquetes buildbot en su computadora, primero agregue la clave de firma del archivo buildbot a su keychain apt ejecutando este comando desde una terminal:

----
sudo apt-key adv --keyserver hkp://keys.gnupg.net --recv-key E0EE663E
----

Cierre la terminal, luego, desde el Menú principal, abra el Administrador de paquetes Synaptic.

Seleccione Buscar en la barra de menú y realice una búsqueda utilizando linuxcnc como término de búsqueda. Haga clic derecho en cualquier resultado de linuxcnc y luego haga clic en Marcar para eliminación. Cuando se seleccionan todos los resultados instalados, haga clic en Aplicar en la barra de menú y se eliminarán.

Haga clic en Configuración en el menú y seleccione Repositorios.

Luego puede editar o eliminar las entradas existentes de LinuxCNC, pero debe terminar con el siguiente conjunto de lineas como las únicas referencias a LinuxCNC:

----
deb     http://buildbot.linuxcnc.org/ <distro> <branch>-<rt_type>
deb-src http://buildbot.linuxcnc.org/ <distro> <branch>-<rt_type>
----

Dónde:

* <distro> es stretch o wheezy
* <rama> es master o 2.8
* <rt_type> es rtpreempt o rt

Por tanto, si instaló la versión 'stretch' y quería la rama master, entonces tendría:

----
deb http://buildbot.linuxcnc.org/ stretch master-rtpreempt
deb-src http://buildbot.linuxcnc.org/ stretch master-rtpreempt
----

Cuando esto se haya completado, Synaptic debería hacer una recarga del paquete, si no hacer una recarga manual desde la barra de menú.

Ahora haga una búsqueda, con linuxcnc como término de búsqueda, y el resultado debería ser una lista de los paquetes LinuxCNC recientemente disponibles

Haga clic derecho en el paquete que desea instalar y luego seleccione Marcar para la instalación.

Para rtpreempt seleccionaría linuxcnc-uspace y para rt sería linuxcnc.

También puede seleccionar la documentación si desea instalarla localmente y/o el paquete -dev si tiene la intención de construir nuevos componentes en tiempo real y/o front-end alternativos para linuxcnc.

Cuando haya hecho todas sus selecciones, haga clic en Aplicar en la barra de menú y se instalarán los paquetes seleccionados.

Vaya a <<sec:testing-linuxcnc,probando la instalación de linuxCNC>>

[[rip-install]]

.Instalacion Run In Place

Para obtener más información sobre una instalación Run In Place, consulte http://linuxcnc.org/docs/master/html/code/building-linuxcnc.html[Construyendo LinuxCNC]

PRECAUCIÓN: asegúrese de *NO* ser el usuario root +
No *use* sudo excepto para el paso 'make setuid'

Abra una ventana de terminal:

----
$ git clone git: //github.com/linuxcnc/linuxcnc.git linuxcnc-dev
$ cd linuxcnc-dev / src
$ ./autogen.sh
----

para RTPREEMPT

----
$ ./configure --with-realtime=uspace
----

Para RTAI (principalmente para máquinas de puerto paralelo)

----
$ ./configure --with-realtime=/usr/realtime-$VERSION
----

Ya puede intentar compilar LinuxCNC.

----
$ make
----

Si obtiene errores aquí, eche un vistazo a http://linuxcnc.org/docs/devel/html/code/building-linuxcnc.html#Satisfying-Build-Dependencies[Satisfacer dependencias de construccion]

Si no hay errores:

----
$ sudo make setuid
$ . ../scripts/rip-environment (es decir,punto, espacio, punto, punto, barra diagonal)
$ linuxcnc
----

Mi método preferido para abrir una versión RIP de LinuxCNC es:

----
$ ~/linuxcnc-dev/scripts/linuxcnc
----

Este script establecerá las variables de entorno requeridas e iniciará linuxcnc.

Luego podría apuntar esto a un archivo .ini y abrir una configuración. Este comando se podría poner en un acceso directo de escritorio.

----
$ ~/linuxcnc-dev/scripts/linuxcnc ~/linuxcnc/configs/plasmac/plasmac.ini
----

[[sec:testing-linuxcnc]]

=== Prueba de instalación de LinuxCNC

El Selector de configuración de LinuxCNC debería abrirse.

Navegue a Configuraciones de muestra - by_machine - plasmac.

Seleccione Axis o Gmoccapy.

Seleccione métrico o imperial.

Ahora tiene todos los requisitos para ejecutar PlasmaC, el siguiente paso es crear una configuración de trabajo para su máquina.

=== Hacer una configuración de máquina base de trabajo

IMPORTANTE: La configuración de la máquina base significa un sistema de trabajo completo sin la configuración de Plasmac. Todos los ejes deben estar funcionando y ajustados para un mejor rendimiento y todos los interruptores de home y de límite, si están instalados, deben funcionar correctamente.

NO agregue ninguna conexión específica de plasma aquí, estas se agregarán más adelante.

[[z_settings]]

Los ajustes recomendados para el eje Z son:

* Z MINIMUM_LIMIT debe estar justo debajo de la parte superior de los listones con márgenes para float_switch_travel y table_discrepencies.
* Z MAXIMUM_LIMIT debe ser el más alto que desea que viaje el eje Z (no debe ser inferior a Z HOME_OFFSET)
* Z HOME debe estar justo por debajo del límite máximo

IMPORTANTE: Debería poder poner su máquina a home, desconectarla, correr a límites soft sin fallar y ejecutar algunos códigos G de prueba sin ningún error.

Cuando se completa esta etapa, puede configurar PlasmaC en la parte superior de su máquina de trabajo.

Puede crear una máquina base manualmente o puede usar ayudantes de configuración existentes:

NOTA: Probablemente sea mejor mantener la configuración de la máquina base simple hasta que la haya probado y ajustado completamente. Si está utilizando stepconf o pncconf, anule las opciones de selección del Panel VCP, el cambio manual de herramientas y classicladder; estas se pueden agregar manualmente más adelante si las necesita.

Si usa una placa Mesa Electronics, use el <<cha:pncconf-wizard,Ayudante pncconf>>:

----
$ pncconf
----

Si usa un puerto paralelo, use el <<cha:stepconf-wizard,Ayudante stepconf>>:

----
$ stepconf
----

Si usa una placa de Pico Systems: +
https://forum.linuxcnc.org/27-driver-boards/14977-pico-systems-faq[Este hilo del foro LinuxCNC] puede ayudar.

Si tiene una configuración de pórtico de doble motor, es posible que deba editar manualmente su configuración para adaptarla a: +
https://forum.linuxcnc.org/49-basic-configuration/33079-how-to-2-or-more-motors-on-one-axis-gantry-linuxcnc-2-8-master?start=0 [Este hilo del foro LinuxCNC] puede ayudar.

=== Añadir PlasmaC a la máquina base

Debe tener una configuración de máquina base totalmente probada y en funcionamiento sin ninguna conexión a un equipo específico de plasma antes de continuar.

PRECAUCIÓN: *NO* continúe hasta que esto se haya hecho

Si está utilizando una tarjeta Mesa Electronics THCAD para medir el voltaje del arco, consulte <<mesa-thcad,Mesa THCAD>> antes de continuar

[[configurator]]

La instalación de una configuración de Plasmac se realiza desde el Configurador, el tipo de instalación determina la ubicación del Configurador (configurator.py):

=== Iniciar una instalación Plasmac BuildBot

Desde una terminal:

====
$ python /user/share/doc/linuxcnc/examples/sample-configs/by_machine/plasmac/configurator.py
====

=== Iniciar una instalación PlasmaC Run In Place

Desde una terminal:

====
$ python ~/linuxcnc-dev/configs/by_machine/plasmac/configurator.py
====

SUGERENCIA: Si el Configurador no se ejecuta, asegúrese de que los permisos de archivo permitan la ejecucion.

=== Instalar

La ventana de selección ahora es visible:

image::images/plasmac_configurator_home_new.png[width=300]

Seleccione 'Nuevo' en la ventana de selección, esto muestra un cuadro de diálogo de información, seleccione 'Continuar' y se mostrará la ventana Nueva configuración.

NOTA: Habrá diferentes campos visibles según el modo que seleccione.

image::images/plasmac_configurator_new.png[width=400]

[[configurator-table]]

[width="100%",cols="4,16"]
|===
|*Campo*|*Descripción*
|Modo|seleccione el modo que necesita +
      0 si usa una señal de voltaje de arco para Arc Voltage y Arc OK +
      1 si usa un arco externo correcto para Arc OK +
      2 si se usa arriba / abajo desde un THC + externo
|Nombre de la máquina|el nuevo nombre de su máquina. Esto creará un directorio ~/linuxcnc/<name> y su archivo .ini será <name>.ini
|Ini File|este es el archivo .ini que creó para la configuración de su máquina base
|Archivo HAL|este es el archivo .hal que creó para la configuración de su máquina base
|Arc OK|Modos 1 y 2 solamente +
        el pin HAL al que ha conectado su señal de arco correcto
|Voltaje de arco|Modos 0 An 1 solo +
             el pin HAL al que ha conectado su señal de voltaje de arco
|Sonda óhmica|solo se requiere si se utiliza la prueba óhmica +
             el pin HAL al que ha conectado su sonda óhmica
|Ohmic Probe Enable|solo es necesario si se usa el sondeo ohmic +
                    el pin HAL al que ha conectado su sonda óhmica permite
|Interruptor flotante|solo si se usa un interruptor flotante +
              el pin HAL al que ha conectado su interruptor flotante
|Interruptor ruptura|solo si se usa un interruptor de ruptura +
                  el pin HAL al que ha conectado su interruptor de ruptura
|Antorcha encendida|el pin HAL al que ha conectado su antorcha
|Mover hacia arriba|Modo 2 solamente +
         el pin HAL al que ha conectado su señal de subida
|Mover hacia abajo|Modo 2 solamente +
           el pin HAL al que ha conectado su señal de bajada
|Ejecutar panel|Ejecutar pestaña = el marco de ejecución es una pestaña detrás de la pestaña de vista previa +
           Panel de ejecución = el marco de ejecución es un panel al lado de la GUI
|Armado de grabadorno|solo se requiere si se usa un air-scribe +
               el pin HAL para armar el trazador de aire
|Scribe Start|solo es necesario si se utiliza un air-scribe +
              el pin HAL para iniciar el trazador de aire
|===

NOTE: Si no está seguro del nombre completo de un pin HAL, inicie LinuxCNC para su máquina base y ejecute 'HalShow' para obtener una lista completa de todos los pines HAL.

Complete las entradas requeridas para adaptarse al cableado de su máquina, haga clic en 'Crear' y debería terminar con una configuración de PlasmaC funcional en ~/linuxcnc/configs/<nombre-maquina>

Esto se puede ejecutar de la siguiente manera:

* Para una instalación buildbot: +
----
$ linuxcnc ~/linuxcnc/configs/<nombre-máquina>.<nombre-máquina>.ini
----

* Para una instalación RIP: +
----
$ ~/linuxcnc-dev/scripts/linuxcnc ~/linuxcnc/configs/<nombre-máquina>.<nombre-máquina>.ini
----

Después de crear una nueva configuración, se requiere un ajuste inicial.

=== Ajuste inicial

LinuxCNC ahora debería ejecutarse con los paneles PlasmaC visibles.
Abra el Panel de configuración y asegúrese de que cada una de estos ajustes se adapte a su máquina.

Consulte <<config-panel, Panel de configuración>>

IMPORTANTE: Si usa una Mesa THCAD, hasta ahora el valor de 'Escala de voltaje' se obtuvo matemáticamente. Si tiene la intención de usar voltajes de corte de las tablas de corte de los fabricantes, sería aconsejable realizar mediciones de los voltajes reales y ajustar la 'Escala de voltaje' y 'Offset de voltaje'.

PRECAUCIÓN: los voltajes de corte de plasma pueden ser letales; si no tiene experiencia en hacer estas mediciones, obtenga ayuda calificada.

[[paso bajo]]

=== Filtro paso bajo

El componente PlasmaC HAL tiene un filtro paso bajo incorporado que tiene el mismo comportamiento que el componente HAL de paso bajo de LinuxCNC. Este filtro, si se utiliza, se aplica a la salida 'plasmac.arc-voltage' de plasmac. El nombre del pin que se utilizará para este filtro es 'plasmac.lowpass-frequency' y, como su nombre indica, ingrese la frecuencia de corte que se requiere; si la frecuencia es cero, entonces no se aplica ningún filtrado.

Se sugiere que si desea utilizar el filtro, la entrada debe estar en el archivo <nombre_maquina>_connections.hal en su directorio de configuración.

----
setp plasmac.lowpass-frequency 100
----

Daría una frecuencia de corte de 100Hz.

== Paneles de la GUI PlasmaC

PlasmaC agrega varios paneles a la GUI; algunos son paneles permanentes en pantalla y otros son pestañas trás la pestaña de vista previa.

Algunas funciones solo se usan para modos particulares y no se muestran si no se requieren.

[[config-panel]]

=== Panel de configuración
Este panel es para parámetros de configuración que se modifican con poca frecuencia.

Es posible desactivar este panel para que personal no autorizado no pueda modificar la configuración de la máquina. Esto se logra estableciendo una variable en el archivo .ini:

----
[PLASMAC] CONFIG_DISABLE = 1
----

Un pin HAL llamado 'plasmac_config.config-disable' se puede configurar a cero para habilitar el panel. Este pin podría estar vinculado a un interruptor con llave o similar, por lo que solo el personal autorizado podría habilitar el Panel de configuración.

image::images/plasmac_config.png[width=400]

.Sondeo

Parámetros relacionados con el sondeo.

[width="100%",cols="4,16"]
|===
|*Nombre*|*Descripción*
|Recorrido flotante|Esta es la cantidad de recorrido en el mecanismo del interruptor flotante. Esto se puede probar con un botón de prueba de sonda, consulte <<custom-user-buttons, botones de usuario personalizados>>.
|Velocidad de la sonda|Esta es la velocidad a la que el eje Z sondeará después de moverse a la Altura de la sonda.
|Altura de la sonda|Esta es la altura por encima del límite inferior del eje Z desde la que comienza el sondeo.
|Offset de la sonda óhmica|El offset del eje Z de la sonda óhmica.
|Reintentos óhmicos|Este es el número de veces que se debe volver a intentar una sonda óhmica si falla antes de recurrir al interruptor flotante.
|Omitir IHS|La distancia utilizada para ver si IHS se puede omitir, consulte <<ihs-skip, Omitir IHS>>.
|===

ADVERTENCIA: La altura de la sonda es la altura por encima del límite mínimo del eje Z.

.THC

Parámetros relacionados con el control de altura de la antorcha.

[width="100%",cols="4,2,14"]
|===
|*Nombre*|*Modos*|*Descripción*
|Retraso|0,1,2|Retraso desde el inicio del corte hasta que se active el THC.
|Umbral|0,1,2|Variación del voltaje objetivo para THC a la altura correcta.
|PID ganancia P (Velocidad)|0,1|Ganancia PID P para THC, velocidad de corrección de THC.
|Umbral VAD|0,1|Porcentaje de velocidad de avance de corte cuya caida por debajo bloquea el THC.
|Ajuste manual de vacíos|0,1|Los valores más altos necesitan un mayor cambio de voltaje para bloquear el THC
|PID ganancia I|0,1|Ganancia PID I para THC
|PID ganancia P|0,1|Ganancia PID D para THC
|===

.Altura segura

Parámetros relacionados con la altura segura.

[width="100%",cols="4,16"]
|===
|*Nombre*|*Descripción*
|Altura segura|Esta es la altura sobre la superficie de trabajo a la que el eje Z se retraerá en movimientos rápidos. +
                   Si se establece en cero, la altura máxima del eje Z se utilizará para la altura segura.
|===

.Arco

Parámetros relacionados con el arco y el voltaje del arco.

[width="100%",cols="4,2,14"]
|===
|*Nombre*|*Modos*|*Descripción*
|Tiempo de espera de fallo|0,1,2|La cantidad de tiempo de espera desde antorcha ON hasta un fallo si no se detecta el arco.
|Máx. Arranques|0,1,2|El número de intentos de iniciar un arco.
|Espera entre intentos|0,1,2|El tiempo entre un fallo de arco y otro intento de arranque de arco.
|Demora de antorcha apagada|0,1,2|La demora de un comando M5 hasta que se apaga la antorcha y se eleva el eje Z.
|Escala de voltaje|0,1|El valor requerido para escalar la entrada de voltaje de arco para mostrar el voltaje de arco correcto.
|Offset de voltaje|0,1|El valor requerido para mostrar cero voltios cuando hay una entrada cero de voltaje de arco. +
                       Para la configuración inicial, multiplique el valor de salida de voltaje de arco por -1 e ingrese eso para la compensación de voltaje.
|Altura por voltio|0,1,2|La distancia que la antorcha necesitaría moverse para cambiar el voltaje del arco en un voltio.
|OK alto Voltios|0|Umbral de alto voltaje para Arc OK.
|OK bajo Voltios|0|Umbral de bajo voltaje para Arc OK.
|===

.Movimiento

Parámetros relacionados con el movimiento.

[width="100%",cols="4,16"]
|===
|*Nombre*|*Descripción *
|Máx. Velocidad|Muestra solo la velocidad máxima de la que es capaz el eje Z.
|Velocidad de configuración|La velocidad del eje Z para los movimientos de configuración. p.ej. Altura de perforación, altura de corte, etc.
|===

NOTA: La velocidad de configuración no tiene efecto en la velocidad de THC que es capaz Max. Velocidad.

[[scribe-config]]

Grabador de aire

Parámetros relacionados con un grabador de aire opcional.

[width="100%",cols="4,16"]
|===
|*Nombre*|*Descripción *
|Retardo del brazo|Retraso para permitir que el grabador de aire alcance la superficie del material antes de comenzar a trazar.
|Retraso de arranque|Retraso para permitir que se inicie Grabador de aire antes de comenzar el movimiento.
|===


.Punteado de Centros

Parámetros relacionados con el punteado de centros (punzón de centros).

IMPORTANTE: Esto es experimental y no se adapta a algunos cortadores de plasma.

[width="100%",cols="4,16"]
|===
|*Nombre*|*Descripción *
|Tiempo de antorcha ON|El tiempo en milisegundos que la antorcha está encendida para cada punto central.
|===

.Botones para guardar y recargar

El botón *'Guardar'* guardará los parámetros que se muestran actualmente como predeterminados.

El botón *'Recargar'* volverá a cargar los últimos parámetros guardados.

=== Panel Ejecución 

Este panel muestra los parámetros que están activos para el corte actual.

Hay dos formatos para este panel, una pestaña detrás de la pestaña de vista previa o un panel al costado de la GUI. Los formatos son diferentes pero la funcionalidad es idéntica.

image::images/plasmac_run.png[width=600]

Consulte <<axis-display-section, sección [DISPLAY] de Axis>> o <<gmoccapy-display-section, sección [DISPLAY] de Gmoccapy>>

.Parámetros de corte

Parámetros relacionados con el corte.

[width="100%",cols="4,16"]
|===
|*Nombre*|*Descripción*
|Material|Selecciona y muestra el material seleccionado actualmente; si no hay materiales en el archivo de material, solo se mostrará el material predeterminado
|Kerf de corte|El ancho de corte para el material seleccionado actualmente
|THC Habilitado|Estado de THC para el material seleccionado actualmente
|Altura de perforación|La altura de perforación para el material seleccionado actualmente
|Retraso de perforación|El retraso de perforación para el material seleccionado actualmente
|Altura de corte|La altura de corte para el material seleccionado actualmente
|Velocidad de alimentación de corte|La velocidad de alimentación de corte para el material seleccionado actualmente
|Amperaje de corte|El amperaje de corte para el material seleccionado actualmente +
                   Indicador de operador solamente
|Voltios de corte|El voltaje de corte para el material seleccionado actualmente
|Altura de salto P|La altura de salto de charco para el material seleccionado actualmente
|Retraso de salto P|El retraso de salto de charco para el material seleccionado actualmente
|===

.THC

Parámetros relacionados con el control de altura de la antorcha.

[width="100%",cols="4,2,14"]
|===
|*Nombre*|*Modos*|*Descripción*
|Estado|0,1,2|Deshabilitado = permanentemente apagado +
              Auto = decide entre THC Habilitado y G-Code +
              Activado = activado, a menos que el Código G lo desactive
|Usar voltios auto|0,1|On = el voltaje de control de THC se muestrea a partir del voltaje de arco +
                       Off = el voltaje de control de THC es de Voltios de corte +
|VAD Habilitado|0,1,2|On = Anti-dive de velocidad habilitado +
                      Off = Anti-dive de velocidad desactivado +
|Sensado de vacios habilitado|0,1|On = La detección de vacíos está habilitada +
                                  Off = La detección de vacío está desactivada

|===

.Sonda óhmica

Parámetros relacionados con el sondeo óhmico.

[width="100%",cols="4,16"]
|===
|*Nombre*|*Descripción*
|Activación de sonda óhmica|Esto es para activar o desactivar la entrada de sonda óhmica.
|===

NOTA: Si la sonda Ohmica está deshabilitada, el LED de la sonda Ohmica seguirá mostrando el estado de la entrada de la sonda.

.Corte simple

Parámetros para un solo corte.

[width="100%",cols="4,16"]
|===
|*Nombre*|*Descripción*
|Longitud del eje X|La distancia del eje X a recorrer para un corte simple.
|Longitud del eje Y|La distancia del eje Y a recorrer para un corte simple.
|Iniciar corte|Presionar para comenzar un corte simple.
|===

. Botones para guardar y recargar

El botón *'Guardar'* guardará los parámetros que se muestran actualmente como predeterminados.

El botón *'Recargar'* volverá a cargar los últimos parámetros guardados.

=== Panel de monitor

El Panel del monitor se usa solo para visualización; tanto Axis como Gmoccapy tienen paneles de monitor similares.

image::images/plasmac_monitor.png[width=400]

[width="100%",cols="6,2,14"]
|===
|*Nombre*|*Modos*|*Descripción*
|Voltaje de arco|0,1|Muestra el voltaje de arco real
|Arco OK|1,2|Indica el estado de la señal de arco ok
|Antorcha encendida|0,1,2|La antorcha está activada
|THC habilitado|0,1,2|Indica si THC está habilitado
|Sonda óhmica|0,1,2|Indica que la sonda ha detectado el material
|Interruptor flotante|0,1,2|Indica que el interruptor flotante está activado
|Ruptura|0,1,2|Indica que el sensor de ruptura está activado
|THC activo|0,1,2|Indica que el THC está activo actualmente
|THC Arriba|0,1,2|Indica que el THC está causando que el eje Z se eleve
|THC Abajo|0,1,2|Indica que el THC está causando que el eje Z baje
|THC Bloqueo Velocidad|0,1,2|Indica que el THC está bloqueado debido a restricciones de velocidad
|THC Bloqueo por vacio|0,1|Indica que el THC está bloqueado debido a que se detecta un vacío
|===

NOTA: El LED de la sonda Ohmica mostrará el estado de la entrada de la sonda independientemente de si la sonda Ohmica está activada o desactivada.


=== Panel de botones

El Panel de botones contiene botones útiles para el funcionamiento de la máquina.

Ambas GUI tienen un botón 'Activar antorcha' que es permanente, todos los demás botones son <<custom-user-buttons, programables por el usuario>> en el archivo .ini. Axis tiene cinco botones de usuario y Gmoccapy tiene cuatro botones de usuario.

Diseño del botón de Axis:

image::images/plasmac_buttons_a.png[width=400]

Diseño del botón Gmoccapy:

image::images/plasmac_buttons_g.png[width=100]

El botón 'Activar antorcha' alterna entre Activado y Desactivado.

Debe estar habilitado para hacer cualquier corte.

Si está deshabilitado, ejecutar un programa cargado hará que el programa realice su ciclo sin que se active la antorcha.

=== Panel de control

El Panel de control permite el control de algunas funciones. Ambas GUI son similares, excepto que el Panel de control Gmoccapy está integrado en el marco que contiene ajustes manuales de alimentación y rápidos.

Estas funciones se habilitan y deshabilitan automáticamente según el estado de la máquina.

Panel de control de Axis:

image::images/plasmac_control_a.png[width=300]

Panel de control de Gmoccapy:

image::images/plasmac_control_g.png[width=300]

.Pulso de la antorcha

Esto enciende la antorcha durante el tiempo establecido en el control deslizante correspondiente.

[[paused-motion]]

.Movimiento en pausa

Cuando un programa está en pausa, permite que el movimiento x/y siga la ruta programada en la dirección inversa o hacia adelante al porcentaje de la velocidad de alimentación actual que se muestra en el ajuste.

Cuando se invierte, el movimiento se detendrá cuando se llegue a un comando que arranque el husillo.

Hacia adelante, el movimiento puede continuar hasta el final del camino.

NOTA: El movimiento en pausa solo está disponible en LinuxCNC versión 2.9 o posterior.

.Cambio de altura

Cada vez que presione Subir o Bajar, la altura de la antorcha cambiará según el valor establecido en Altura por voltio en el marco de Arco del Panel de configuración. 'Restablecer' cancelará cualquier anulación de altura.

=== Panel de estadísticas

Proporciona estadísticas para permitir el seguimiento del desgaste de consumibles y los tiempos de trabajo.

Se muestran para el trabajo actual y también se muestran como un total acumulado.

Las estadísticas de trabajo se restablecen cuando se ejecuta el programa actual.

Los valores totales se pueden restablecer individualmente o todos juntos.

image::images/plasmac_stats.png[width=400]

=== Panel de extras

Proporciona una biblioteca de formas con algunas formas simples que se pueden seleccionar y cargar en LinuxCNC.

También proporciona diez botones de usuario personalizados que funcionan igual que los otros botones de usuario personalizados, además de que tienen la capacidad de cargar un programa GCode y mostrar una imagen en el botón.

Ver <<shape-library, biblioteca de formas>> para el uso de las formas.
 
Vea <<custom-user-buttons, botones de usuario personalizados>> para el uso de los botones.

image::images/plasmac_extras.png[width=400]

El panel Extras se puede deshabilitar comentando las entradas apropiadas en la sección [DISPLAY] del archivo .ini. Esto no tendrá ningún efecto en el funcionamiento de la configuración de PlasmaC.

== Usando PlasmaC

El único requisito obligatorio de Código G para una configuración de PlasmaC es 'M3 $0 S1' para comenzar un corte y 'M5' para finalizarlo, además, por supuesto, de códigos de movimiento estándar para moverse de principio a fin.

Si está utilizando PlasmaC sin habilitar <<multi-tool, múltiples herramientas>> , entonces está permitido usar 'M3 S1' en lugar de 'M3 $0 S1' para comenzar un trabajo de corte.

=== Coordenadas

Consulte la configuración del <<z_settings, eje Z recomendada>>.

Cada vez que se inicia LinuxCNC, se requiere homing. Esto permite que LinuxCNC sepa en qué parte de las coordenadas universales está la antorcha y establece los límites soft a los valores especificados en el archivo .ini, evitando así que la máquina choque en un limite hard durante el uso normal.

Si su máquina no tiene interruptores home, entonces debe asegurarse de que todos los ejes estén en las coordenadas de inicio especificadas en el archivo .ini antes del homing.

Si su máquina tiene interruptores home, se moverá a las coordenadas de inicio especificadas cuando se le indique.

Dependiendo de su configuración, es posible que tenga un botón 'A Origen todo' o que necesite iniciar cada eje individualmente. Use el botón/botones apropiados para iniciar la máquina.

Después del homing de la antorcha, necesita saber dónde está el material, esto se logra con 'Touch Off'.

Se recomienda que la primera vez que use PlasmaC, mueva el eje Z hacia abajo hasta cerca de los listones y 'toque' el eje Z con un desplazamiento cero. Cuando termine, mueva el eje Z hasta donde estaba originalmente. Esto no debería necesitar hacerse nuevamente. De ahora en adelante, deje el eje Z en esta posición, ya que PlasmaC controlará todo el movimiento del eje Z.

Si tiene la intención de colocar su material en el mismo lugar en la mesa cada vez, entonces podría mover los ejes X e Y a la posición X0, Y0 del material y luego 'Tocar' ambos ejes con un desplazamiento cero.

Si tiene la intención de colocar el material al azar en la mesa, entonces antes de cada trabajo deberá 'Tocar' como se indicó anteriormente o colocar el material en la ubicación anterior.

[[path-tolerance]]

=== Tolerancia de ruta

Los archivos <<rs274, RS274NGC_STARTUP_CODE>> proporcionados, metric_startup.ngc e imperial_startup.ngc establecen la tolerancia de ruta a 0.1 mm (0.004") con un comando G64. Si LinuxCNC ve un Estop en cualquier momento, entonces la tolerancia de ruta si se configura por defecto, lo que redondeará las esquinas, por lo que se recomienda que la tolerancia de ruta se establezca en el encabezado de cada archivo GCode.

[[multi-tool]]

=== Herramientas múltiples

Esto permite el uso de más de una herramienta; las herramientas válidas son:

* Antorcha de plasma: para corte normal
* Grabador de aire - para grabar
* Antorcha de plasma: para punteo de centros

Si se habilitan varias herramientas, se requiere un número de herramienta LinuxCNC en el comando 'M3 para seleccionar la herramienta requerida.

* 'M3 $0 S1' seleccionará la herramienta de corte por plasma.
* 'M3 $1 S1' seleccionará el grabador de aire.
* 'M3 $2 S1' seleccionará la herramienta de punteo de centros.

Para habilitar la función de herramientas múltiples, debe editar la siguiente línea en <NOMBRE_MÁQUINA>_connections.hal.

de:

-----
setp plasmac.multi-tool 0
-----

a:

-----
setp plasmac.multi-tool 1
-----

PlasmaC leerá los parámetros de corte del Panel de ejecución y los usará cuando sea necesario.

[[material-handling]]

=== Manejo de materiales

El manejo de materiales no tiene nada que ver con la tabla de herramientas LinuxCNC, sino que utiliza un archivo de materiales que se creó al mismo tiempo que la configuración.

La tabla de herramientas de LinuxCNC y los comandos de herramientas solo entran en juego si está utilizando un <<air-scribe, grabador de aire>> además de la antorcha de plasma.

Hay un <<material-file, archivo de material>> con su nombre derivado de '[EMC]MACHINE' en el archivo ini, por lo que una máquina llamada 'METRIC_PLASMAC' tendría un archivo de material llamado 'metric_plasmac_material.cfg'.

No es un requisito que utilice un archivo de material; si es necesario, puede cambiar los parámetros de corte manualmente en el Panel de ejecución. Tampoco es un requisito utilizar los cambios automáticos de material, simplemente omítalos del archivo G-Code.

Los siguientes códigos pueden usarse para una configuración de PlasmaC:

* 'M190 Pn': cambia el material al número n.
* 'M66 P3 L3 Q1': espera a que se confirme el cambio de material.
* 'F#<_hal[plasmac.cut-feed-rate]>': establece la velocidad de alimentación a la velocidad de alimentación que se muestra en los parámetros de corte del panel Ejecutar.
* 'M3 $0 S1': inicia el componente PlasmaC.

Para el manejo manual de materiales, seleccione manualmente el material de la lista de materiales en el Panel de ejecución antes de ejecutar su GCode, que debe tener el siguiente código mínimo:

----
F#<_hal[plasmac.cut-feed-rate]>
M3 $0 S1
...
M5
----

NOTA: El manejo manual de materiales lo restringe a un solo material para todo el trabajo.

Para el manejo automático de materiales, los códigos DEBEN estar en el orden mostrado.
Podrías tener otros códigos entre ellos.
En su código G necesita:

----
M190 Pn
M66 P3 L3 Q1
F#<_hal[plasmac.cut-feed-rate]>
M3 $0 S1
...
M5
----

Los números de material no necesitan ser consecutivos ni estar en orden numérico.

Cuando se cambia un material, solo cambia los parámetros de corte en el Panel de Ejecución, LinuxCNC no sabe nada del material ni PlasmaC sabe nada sobre las herramientas de LinuxCNC. (es decir, NO hace un cambio de herramienta)

Los materiales se pueden seleccionar manualmente con el cuadro combinado Parámetros de corte o mediante MDI con M190 Pn.

=== THC

NOTA: Todas las referencias a CutFeedRate significan Velocidad de avance de corte como se muestra en el Panel de Ejecución.

El THC se puede controlar desde el recuadro de THC del panel de ejecución, apagado=deshabilitado, encendido=habilitado y automático significa cumplir con la casilla de verificación THC Habilitado en los parámetros de corte.

El THC también se puede habilitar o deshabilitar directamente desde G-Code, siempre que el THC no esté deshabilitado en el Panel de Ejecución.

PlasmaC utiliza un voltaje de control que depende del estado de la casilla de verificación Usar Voltios Auto en el Panel de Ejecución:

. Si se selecciona Usar Voltios Auto, el voltaje de corte real se muestrea después de que comienza el corte y luego se usa como voltaje de control. Para permitir que el voltaje del arco se estabilice, PlasmaC espera la cantidad de tiempo que se muestra como Retraso en el recuadro de THC del Panel de Ejecucion antes de tomar la muestra.
. Si la opción Usar Voltios Auto no está marcada, el voltaje que se muestra como Voltios de corte en el cuadro Parámetros de corte del panel de Ejecución se usa como voltaje de control.

El THC no se activa hasta que la velocidad alcanza el 99.9% de 'CutFeedRate'.

.Codigo-G con THC

El THC puede deshabilitarse y habilitarse directamente desde el Código G, siempre que el THC no esté deshabilitado en el Panel de Ejecución, configurando o restableciendo el pin 'motion.digital-out-02' con los codigos M M62-M65:

* 'M62 P2' desactivará el THC (sincronizado con el movimiento)
* 'M63 P2' habilitará THC (sincronizado con movimiento)
* 'M64 P2' desactivará el THC (inmediatamente)
* 'M65 P2' habilitará THC (inmediatamente)

[[velocity_thc]]

. THC basado en la velocidad

Si la velocidad de corte cae por debajo de un porcentaje de 'CutFeedRate', el THC se bloqueará hasta que la velocidad de corte vuelva al menos al 99% de 'CutFeedRate'.

Este porcentaje se muestra como % de Umbral VAD en el recuadro de THC de la pestaña Configuración.

El THC basado en la velocidad evita que se cambie la altura de la antorcha cuando la velocidad se reduce en una esquina aguda o un pequeño agujero.

Hay un pin HAL disponible llamado 'motion.analog-out-03' que se puede cambiar en Codigo-G con los comandos M67/M68. Este pin reducirá la velocidad al porcentaje especificado en el comando.

* 'M67 E3 Q0' establecería la velocidad al 100% de 'CutFeedRate'.
* 'M67 E3 Q40' establecería la velocidad al 40% de 'CutFeedRate'.
* 'M67 E3 Q60' establecería la velocidad al 60% de 'CutFeedRate'.
* 'M67 E3 Q100' establecería la velocidad al 100% de 'CutFeedRate'.

El porcentaje mínimo permitido es del 10%, los valores por debajo de este se establecerán en el 100%.

El porcentaje máximo permitido es 100%, los valores superiores a este se establecerán en 100%.

Si tiene la intención de utilizar esta función, sería prudente agregar 'M68 E3 Q0' a su preámbulo y posámbulo del código G para que comience y termine en un estado conocido.

CONSEJO: Otra forma de lograr el mismo resultado es usar 'F#<_hal[plasmac.cut-feed-rate]' con un multiplicador.

----
F[#<_hal[plasmac.cut-feed-rate] * 0.6]
----

ADVERTENCIA: Si la velocidad de avance de corte en el panel de ejecución se establece en cero, entonces PlasmaC usará 'motion.requested-speed' para los cálculos de THC, que no es una forma muy confiable de THC basada en la velocidad y no se recomienda.

=== Compensación del cortador

Para usar la compensación del cortador, deberá usar G41.1, G42.1 y G40 con el pin HAL de ancho de corte:

* 'G41.1 D#<_hal[plasmac_run.kerf-width-f]>'; para la izquierda de la ruta programada
* 'G42.1 D#<_hal[plasmac_run.kerf-width-f]>'; a la derecha de la ruta programada
* 'G40' para desactivar la compensación

[[ihs-skip]]

=== Omitir IHS (sensado de altura inicial)

IHS se puede omitir de dos maneras diferentes:

Si el THC está desactivado, omita IHS si el inicio del corte es menor que 'plasmac.skip-ihs-distance' desde el último sondeo con exito.

Si el THC está habilitado, omita IHS si el inicio del corte es menor que 'plasmac.skip-ihs-distance' desde el final del último corte.

=== Sondeo

El sondeo puede ser con detección óhmica o con un interruptor flotante. También es posible combinar ambos, con el interruptor flotante respaldando al sondeo óhmico.

Si su antorcha no admite sondeo óhmico, podría tener una sonda separada al lado de ella. En este caso, extendería la sonda debajo de la antorcha. La sonda NO debe extenderse más allá de su Altura mínima de corte por debajo de la antorcha y esta distancia de compensación se ingresa como 'ohmic-probe-offset' en el Panel de configuración.

La configuración del sondeo se realiza en el cuadro Movimiento de la pestaña Configuración.

ADVERTENCIA: La altura de la sonda es la altura por encima del límite mínimo del eje Z.

[[cut-types]]

=== Tipos de corte

PlasmaC permite dos tipos de corte diferentes:

* Perforar y cortar: ejecuta el programa G-Code cargado para perforar y luego cortar.
* Solo perforación: convierte y luego ejecuta el programa GCode cargado para hacer solo perforaciones.

El modo de solo perforación es útil para materiales gruesos que pueden producir suficiente escoria en la superficie del material al perforar para que interfieran con la antorcha durante el corte. Esto permite perforar y limpiar toda la plancha antes de cortarla.

Esto también permite que los consumibles al final de su vida útil se usen para perforar y se pueden cambiar por consumibles frescos para cortar.

Hay dos formas de habilitar esta función:

* Programe un <<button-cut, botón de usuario personalizado>> para alternar entre los tipos de corte.
* Agregar una línea '<pierce-only> = 1' en cualquier parte de un archivo gcode para habilitar el modo Solo perforación para el archivo actual.

Si usa un botón de usuario personalizado, la GUI volverá a cargar automáticamente el archivo cuando se cambie el tipo de corte.

=== Corte de agujeros - Introducción

Se recomienda que los orificios que se corten tengan un diámetro no inferior a una vez y media el grosor del material a cortar.

También se recomienda que los agujeros con un diámetro de menos de 32 mm (1.26 ") se corten al 60% de la velocidad de alimentación utilizada para los cortes de perfiles. Esto también debería bloquear el THC debido a restricciones de velocidad.

PlasmaC puede utilizar comandos G-Code generalmente configurados por un postprocesador CAM (PP) para ayudar en el corte de agujeros o si no tiene un PP o su PP no admite estos métodos, entonces PlasmaC puede adaptar automáticamente el G-Code para acomodarlos. Este modo automático está deshabilitado por defecto.

Hay tres métodos disponibles para mejorar la calidad de los agujeros pequeños.

.Reducción de Velocidad

Reduzca la velocidad a aproximadamente el 60% de 'CutFeedRate'.

.Retraso de Arco off (Arc Dwell):

Mantenga la antorcha encendida por un corto tiempo mientras se detiene todo el movimiento para permitir que el arco empareje.

Sobrecorte (Overcut):

Apague la antorcha al final del orificio y luego continúe a lo largo de la trayectoria del orificio durante aproximadamente 4 mm (0.015").

NOTA: Si tanto 'Arc Dwell' como 'Overcut' están activos al mismo tiempo, entonces 'Overcut' tendrá prioridad.


=== Corte de agujeros - Comandos G-Code

Sus comandos G-Code se configuran mediante un postprocesador CAM (PP) o mediante codificación manual.

.Reducción de Velocidad

Si un agujero requiere una velocidad reducida, establezca la velocidad con 'M67 E3 Q60' que establecería la velocidad al 60% de 'CutFeedRate'.

Consulte la sección <<velocity_thc, THC basado en velocidad>>.

.Retraso de Arco off (Arc Dwell):

Mantenga el movimiento durante un tiempo configurando el 'Retardo de apagado' en el recuadro del arco del <<config-panel, Panel de configuración>>

Sobrecorte:

La antorcha se puede apagar al final del agujero colocando el pin 'motion.digital-out-03' con los códigos M 'M62' o 'M64'. Después de apagar la antorcha, es necesario permitir que la antorcha se encienda nuevamente restableciendo el pin 'motion.digital-out-03' con los códigos M 'M63' o 'M65', esto se hará automáticamente por el Analizador G-Code PlasmaC si alcanza un comando M5 sin ver un 'M63 P3' o 'M65 P3'.

Después de que se apague la antorcha, se debe seguir la trayectoria del orificio durante aproximadamente 4 mm (0.15 ")

* 'M62 P3' apagará la antorcha (sincronizada con el movimiento)
* 'M63 P3' permitirá encender la antorcha (sincronizada con el movimiento)
* 'M64 P3' apagará la antorcha (inmediatamente)
* 'M65 P3' permitirá encender la antorcha (inmediatamente)

Código de ejemplo:

----
G21 (métrico)
G64 P0.005
M52 P1 (permitir pausa del movimiento)
F#<_hal[plasmac.cut-feed-rate]> (velocidad de alimentación de los parámetros de corte)
G0 X10 Y10
M3 $0 S1 (corte inicial)
G1 X0
M67 E3 Q60 (reducir la velocidad de alimentación al 60%)
G3 I10 (el agujero)
M62 P3 (apaga la antorcha)
G3 X0.8 Y6.081 I10 (movimiento continuo durante 4 mm)
M63 P3 (permitir encender antorcha)
M67 E3 Q0 (restaurar la velocidad de alimentación al 100%)
M5 (corte final)
G0 X0 Y0
M2 (fin trabajo)
----

=== Corte de agujeros - Automático

PlasmaC tiene la capacidad de modificar automáticamente el G-Codel para reducir la velocidad y/o aplicar 'Overcut'.

El tamaño de orificio predeterminado para la detección de orificios PlasmaC es 32 mm (1.26"). Es posible cambiar este valor con los siguientes comandos:

* #<m_diameter> = nn - Para establecer un diámetro en medidas métricas
* #<i_diameter> = nn - Para establecer un diámetro en medidas imperiales

La detección de agujeros PlasmaC se habilita/deshabilita configurando el siguiente parámetro G-Code. Está deshabilitado por defecto.

* #<holes> = 0 - Desactiva la detección de agujeros.
* #<holes> = 1 - Hace que PlasmaC reduzca la velocidad de los agujeros de menos de 32 mm (1,25 ") al 60% de 'CutFeedRate'.
* #<holes> = 2 - Además de la reducción de velocidad anterior, también apaga la antorcha al final del agujero y sigue la trayectoria del mismo durante 4 mm más (0.015").

.Retraso de Arco off (Arc Dwell):

Mantenga el movimiento durante un tiempo configurando el 'Retardo de apagado' en el recuadro del arco del <<config-panel, Panel de configuración>>

Use #<holes> = 1 para permitir la reducción de velocidad.

Código de ejemplo:

----
G21 (métrico)
G64 P0.005
M52 P1 (permitir pausa en movimientos)
F#<_hal[plasmac.cut-feed-rate]> (velocidad de alimentación de los parámetros de corte)
#<holes> = 1 (reducción de velocidad para agujeros)
G0 X10 Y10
M3 $ 0 S1 (corte inicial)
G1 X0
G3 I10
M5 (corte final)
G0 X0 Y0
M2 (fin trabajo)
----

.Sobrecorte:

Use #<holes> = 2 para permitir la reducción de velocidad y el sobrecorte.

Código de ejemplo:

----
G21 (métrico)
G64 P0.005
M52 P1 (permitir pausa en movimientos)
F#<_hal[plasmac.cut-feed-rate]> (velocidad de alimentación de los parámetros de corte)
#<holes> = 2 (Sobrecorte para agujeros)
G0 X10 Y10
M3 $0 S1 (corte inicial)
G1 X0
G3 I10
M5 (corte final)
G0 X0 Y0
M2 (fin trabajo)
----

[NOTA]
====
* Es correcto tener múltiples comandos mezclados #<*_diámetro> en un archivo G-Code.
* Es correcto tener múltiples comandos mezclados #<holes> en un archivo G-Code.
====

=== Corte individual

Un corte único es un movimiento de corte unidireccional que se usa a menudo para cortar una hoja en secciones más pequeñas antes de ejecutar un programa GCode.

La máquina debe tener hecho homing antes de comenzar el corte.

Un corte simple comenzará desde la posición X/Y actual de la máquina.

.Corte simple automático

Este es el método preferido y los parámetros para este método se ingresan en el Panel de Ejecución.

. Avance a la posición de inicio X/Y requerida. +
. Establezca la velocidad de avance de corte requerida en los parámetros de corte del Panel de Ejecución. +
. Ingrese la longitud del corte a lo largo de los ejes X y/o Y. +
. Presione el botón 'Iniciar corte' y comenzará el corte.


.Corte simple con Colgante

Si tiene un colgante que puede iniciar y detener el husillo, y además mover los ejes X e Y, entonces puede realizar manualmente un solo corte.

. Avance a la posición de inicio X/Y requerida. +
. Establezca la velocidad de alimentación requerida con el control deslizante Velocidad Jog. +
. Comience el procedimiento arrancando el husillo. +
. Después de sondear, la antorcha se encenderá. +
. Cuando se recibe Arc OK, la máquina se podrá desplazar a lo largo de la línea de corte con los botones de desplazamiento. +
. Cuando se complete el corte, detenga el husillo. +
. La antorcha se apagará y el eje Z volverá a la posición inicial.

.Corte manual simple en Axis.

. Avance a la posición de inicio X/Y requerida. +
. Establezca la velocidad de alimentación requerida con el control deslizante Velocidad Jog. +
. Inicie el procedimiento presionando 'F9'. +
. Después de sondear, la antorcha se encenderá. +
. Cuando se recibe Arc OK, la máquina se podrá mover a lo largo de la línea de corte con las teclas de desplazamiento. +
. Cuando el corte esté completo, presione 'F9' o 'Esc'. +
. La antorcha se apagará y el eje Z volverá a la posición inicial.

.Corte manual simple en Gmoccapy

Si desea utilizar las teclas de desplazamiento del teclado, habilite los métodos abreviados de teclado en la pestaña Hardware de la página Configuración; de lo contrario, utilice los botones de desplazamiento de la GUI.

. Avance a la posición de inicio X/Y requerida. +
. Establezca la velocidad de alimentación requerida con el control deslizante Velocidad Jog. +
. Ingrese al modo MDI. +
. Inicie el procedimiento ingresando 'M3 S1'. +
. Ingrese al modo manual. +
. Después de sondear, la antorcha se encenderá. +
. Cuando se recibe Arc OK, la máquina se podrá mover a lo largo de la línea de corte utilizando los botones de avance (o las teclas de avance si están habilitadas). +
. Cuando el corte esté completo, presione 'Esc'. +
. La antorcha se apagará y el eje Z volverá a la posición inicial.

[[shape-library]]

== Biblioteca de formas

La biblioteca de formas no está destinada a ser un reemplazo CAD/CAM y existen limitaciones en cuanto a lo que se puede lograr.

Las entradas en blanco en los cuadros de diálogo de forma utilizarán lo que este activo en ese momento. p.ej. Si 'X start' estaba en blanco, se usaría la posición actual del eje X.

Todas las entradas y salidas son arcos, excepto:

* Pequeños agujeros
* Estrellas

El botón 'Nuevo' en el Panel Extras solo es necesario si desea comenzar un nuevo trabajo y existe un trabajo actual.

Todas las distancias están en unidades de máquina y todos los ángulos están en grados.

=== Configuración

La configuración global de la biblioteca de formas se puede hacer presionando 'Configuración' en el Panel de extras. Aparecerá el cuadro de diálogo de configuración para permitir cambiar y guardar estas configuraciones globales.

Los parámetros predeterminados disponibles son:

* Preámbulo
* Postambulo
* Longitud de entrada
* Longitud de salida
* Diámetro de agujero pequeño
* Velocidad de agujero pequeño

Cualquier círculo interno que tenga un diámetro menor que 'Diámetro de agujero pequeño' se clasifica como un agujero pequeño. Tendrá una entrada recta con una longitud menor del radio del orificio y la longitud de entrada especificada. También tendrá su velocidad de alimentación establecida en 'Velocidad de agujero pequeño'.

=== Forma única

. Abra el Panel de extras.
. Seleccione la forma que desea crear que abrirá un cuadro de diálogo de forma.
. Abra el Panel de vista previa y mueva el cuadro de diálogo de forma para que pueda ver el Panel de vista previa.
. Ingrese los valores apropiados en el diálogo de forma y presione 'Vista previa' para cargar la forma.
. Si la forma no es correcta, edite los valores y presione 'Vista previa' y se mostrará la nueva forma. Repita hasta que esté satisfecho con la forma.

=== Formas Múltiples

Se pueden agregar varias formas para crear un trabajo complejo.

El orden de corte del trabajo está determinado por el orden en que se agregan las formas individuales al trabajo.

Una vez que se agrega una forma al trabajo, no se puede editar ni eliminar.

Los trabajos no se pueden editar, solo agregar.

. Cree la primera forma como en 'Forma única'.
. Presione 'Agregar' y la forma se agregará al trabajo.
. Si desea agregar otra versión de la misma forma, edite los parámetros como en el n° 5 anterior y presione 'Agregar' cuando esté satisfecho con la forma.
. Si desea agregar una forma diferente, presione 'Volver' en el cuadro de diálogo de forma y cree una nueva forma nueva como en 'Forma única'.
. Repita hasta que haya completado la adición de todas las formas requeridas.

=== Matriz de formas

Cuando esté satisfecho con el trabajo que ha creado, se puede crear una matriz.

El orden de corte de una matriz es de izquierda a derecha, comenzando en la fila inferior y terminando en la fila superior.

. Presione 'Array' en el Panel de Extras que abrirá el cuadro de diálogo de la matriz.
. Abra el Panel de vista previa y mueva el cuadro de diálogo de matriz para que pueda ver el Panel de vista previa.
. Ingrese los valores apropiados en el cuadro de diálogo de la matriz y presione 'Vista previa' para cargar la matriz.
. Si la matriz no es correcta, edite los valores y presione 'Vista previa' y se mostrará la nueva matriz. Repita hasta que esté satisfecho con la forma.
. Presione 'Aceptar' para completar el procedimiento.

=== Guardar un trabajo

El trabajo actual que se muestra en el Panel de vista previa se puede guardar en cualquier momento utilizando la función 'Guardar' del Editor de código GC en la GUI.

=== Ejecutar un trabajo

El trabajo actual que se muestra en el Panel de vista previa se puede ejecutar en cualquier momento.

[[air-scribe]]

== Grabador de aire

PlasmaC puede operar un grabador de aire además de la antorcha de plasma. Esto está deshabilitado de manera predeterminada para no afectar las configuraciones existentes.

El uso de un grabador de aire requiere el uso de la tabla de herramientas LinuxCNC, la herramienta 0 se asigna a la antorcha de plasma y la herramienta 1 se asigna al grabador de aire. Los offsets de los ejes X e Y del grabador de aire desde la antorcha de plasma deben ingresarse en la tabla de herramientas de LinuxCNC; los offsets de la antorcha de plasma siempre serán cero. Las herramientas se seleccionan mediante el comando 'Tn M6' y luego se requiere un 'G43 H0' para aplicar los desplazamientos. PlasmaC se inicia con un comando 'M3 $n S1'. En 'n', use 0 para corte por plasma o 1 para grabador de aire.

Hay dos pines de salida HAL utilizados para operar el grabador de aire; uno para armar el marcador de aire que lo mueve a la superficie del material y después un <<scribe-config, retraso>> y el otro, para arrancarlo y después de un << scribe-config, retraso>> se iniciará el movimiento.

El uso de PlasmaC después de habilitar el grabador de aire requiere seleccionar la antorcha o el grabador en cada archivo G-Code como una herramienta LinuxCNC.

Para habilitar la escritura, vea <<multi-tool, herramientas múltiples>>.

Si aún no ha asignado los pines HAL para el grabador de aire en el Configurador, deberá hacerlo invocando el modo <<modify-config, reconfigurar>> del Configurador.

El grabador de aire ahora está activo y la acción de armado se puede probar emitiendo un comando 'M3 $1 S1' en la entrada MDI. Esto hará que el trazador de aire se arme, pero no lo arrancará.

El siguiente paso es abrir el editor de tablas de herramientas en la GUI e ingresar los offsets de los ejes X e Y. Estas son las distancias en X e Y desde el centro de la boquilla de la antorcha. En la mayoría de los casos, visto desde la parte delantera de la máquina, si el grabador de aire está a la derecha de la antorcha, sería un valor positivo y si está detrás de la antorcha, también sería un valor positivo . Los offsets para la antorcha siempre deben ser cero.

El paso final es establecer los <<scribe-config, retrasos del grabador de aire>> necesarios:

. Retraso de armado, permite que el grabador de aire descienda hasta la superficie del material.
. Retraso de arranque, permite que el grabador de aire arranque antes de que comience el movimiento.

Guarde los parámetros de configuración.

El material se puede alinear con la antorcha como anteriormente y se pueden aplicar los desplazamientos para que ambas herramientas funcionen en las coordenadas correctas.

Para usar el grabador de aire con G-Code:

-----
...
M52 P1 (movimiento en pausa activado)
F#<_hal[plasmac.cut-feed-rate]>
T1 M6 (selecciona grabador de aire)
G43 H0 (aplicar ofsets)
M3 $1 S1 (comenzar plasmac con grabador de aire)
...
T0 M6 (seleccionar antorcha)
G43 H0 (aplicar ofsets)
G0 X0 Y0 (posición de estacionamiento)
M5 (final)
-----

Es una buena idea volver a encender la antorcha al final del programa antes de su último movimiento de estacionamiento rápido para que su máquina esté siempre en el mismo estado en reposo.

Puede cambiar entre la antorcha y el trazador de aire cualquier número de veces durante un programa utilizando el código anterior y emitiendo 'M3 $0 S1' para iniciar PlasmaC con la antorcha.

La emisión de M3 S1 (sin $n) hará que la máquina se comporte como si se hubiera emitido un 'M3 $0 S1', por lo que la máquina intentará cortar con antorcha. Esto es para proporcionar compatibilidad con archivos G-Code anteriores.

ADVERTENCIA: Si tiene un cambio de herramienta manual existente en el archivo .hal de su máquina, entonces PlasmaC lo convertirá en un cambio de herramienta automático.

== Marcado de Centros

IMPORTANTE: Esto es experimental y no se adapta a algunos cortadores de plasma.

Para facilitar la localización del centro antes de perforar, PlasmaC puede pulsar la antorcha durante un período corto para marcar el punto del centro de perforación.

Esto se hace ajustando primero el tiempo de encendido de la antorcha en el <<config-panel, Panel de configuración>>. Los tiempos son ajustables de 1 a 999 milisegundos.

Luego, se enciende la antorcha en G-Code con el comando 'M3 $2 S1' que selecciona la antorcha de plasma como herramienta de marcado de punto central.

Para habilitar la localización central, vea <<multi-tool, herramientas múltiples>>.

LinuxCNC requiere algo de movimiento entre un comando 'M3' y un comando 'M5', por lo que se necesita un movimiento mínimo a alta velocidad.

Un ejemplo en G-Code seria:

-----
G21 (métrico)
F99999 (alta velocidad de alimentación)

g0 x10 y10
m3 $2 s1 (marcado centro on)
g91 (modo de distancia relativa)
g1 x0.000001
g90 (modo de distancia absoluta)
m5 (marcado centro apagado)

g0 x0 y0
g90
m30
-----

NOTA: La 'velocidad de alimentación alta' es para garantizar que el movimiento se encuentre en la velocidad de alimentación más alta de la máquina.

== Mensajes de error

Hay una serie de mensajes de error que imprime PlasmaC. Probablemente podrían dividirse en dos grupos, 'Crítico' y 'Advertencia'.

=== Errores críticos

Los errores críticos harán que el programa haga una pausa; el operador debe borrar la causa del error.

Si el error fue durante el corte, entonces se permite el movimiento hacia adelante o hacia atrás para permitir que la máquina se posicione para reiniciar el corte.

Cuando se borra el error, se puede reanudar el programa.

Estos errores indican que el sensor correspondiente se activó durante el corte.

* 'activado interruptor de ruptura, programa en pausa'
* 'activado interruptor flotante, programa en pausa'
* 'activada la sonda óhmica, programa en pausa'
* 'pérdida de arco valido, programa en pausa'

Estos errores indican que el sensor correspondiente se activó antes de comenzar el sondeo.

* 'detección sonda óhmica antes de mover a altura de sonda, programa en pausa'
* 'interruptor flotante detectado antes mover altura de sonda, programa en pausa'
* 'interruptor de ruptura detectado antes de mover a altura de sonda, programa en pausa'

Estos errores indican que el sensor correspondiente se activó mientras el eje Z se movia de arriba hacia abajo a la altura de la sonda.

ADVERTENCIA: La altura de la sonda es altura por encima del límite mínimo del eje Z.

* 'interruptor flotante detectado mientras se mueve a altura de sonda, programa en pausa'
* 'sonda óhmica detectada mientras se mueve a altura de sonda, programa en pausa'

El eje Z alcanzó el límite inferior antes de que se detectara la pieza de trabajo.

* 'límite inferior alcanzado en sondeo, programa en pausa'

La pieza de trabajo es demasiado alta para cualquier movimiento rápido seguro.

* 'material demasiado alto para rapidos seguros, programa en pausa'

Uno de estos valores en Parámetros de corte en el Panel de Ejecución no es válido.

* 'altura de perforación no válida o altura de corte no válida o voltios de corte no válidos'

No se detectó ningún arco después de intentar iniciar el número de veces indicado por Intentos de inicio de arco en la pestaña Configuración.

* 'no se detecta arco después de <n> intentos de arranque, programa en pausa'

El THC ha provocado que se alcance el límite inferior durante el corte.

* 'límite inferior alcanzado mientras el THC movia hacia abajo, programa en pausa'

El THC ha provocado que se alcance el límite superior durante el corte.

* límite superior alcanzado mientras el THC movia hacia arriba, programa en pausa '


=== Errores de advertencia

Los errores de advertencia no tienen efecto en un programa en ejecución y son solo informativos.

Estos errores indican que el sensor correspondiente se activó antes de que comenzara una prueba de sonda.

* 'sonda óhmica detectada antes de pasar a la altura de la sonda'
* 'interruptor flotante detectado antes de pasar a la altura de la sonda'
* 'interruptor de ruptura detectado antes de pasar a la altura de la sonda'

Estos errores indican que el sensor correspondiente se activó mientras el eje Z se mueve de arriba hacia abajo a la altura de la sonda durante una prueba de sonda.

* 'interruptor flotante detectado mientras se mueve a la altura de la sonda'
* 'sonda óhmica detectada mientras se mueve a la altura de la sonda'

Esto indica que se perdió el contacto de la sonda antes de sondear hasta el punto cero.

* 'error de disparo de la sonda al sondear'

Esto indica que se alcanzó el límite inferior durante una prueba de sonda.

* 'límite inferior alcanzado durante la prueba de la sonda'

Esto indica que la altura segura se ha reducido debido a que el THC eleva el eje Z durante el corte.

* 'se ha reducido la altura de rapidos segura'

== Archivo INI

PlasmaC requiere algunas variables de archivo .ini específicas de la siguiente manera:

=== Común

.Sección [PLASMAC]

-----
MODE                = 0 (use voltaje de arco externo para voltaje de arco)
                        (use voltaje de arco externo para Arc OK)
                    = 1 (use entrada de voltaje de arco externo para voltaje de arco)
                        (use entrada de Arc OK externa para Arc OK)
                    = 2 (use entrada de Arc OK externa para Arc OK)
                        (use arriba/abajo externo para THC)

CONFIG_DISABLE      = 0 (0 = activar o 1 = desactivar el panel de configuración de PlasmaC)
PAUSED-MOTION-SPEED = n (multiplicador de velocidad de avance de corte para velocidad de movimiento en pausa)
TORCH-PULSE-TIME    = n (tiempo para antorcha ON en pulso manual)
BUTTON_n_NAME       = <NAME> (nombre de botón de usuario personalizado)
BUTTON_n_CODE       = <CODE> (código ejecutado por botón de usuario personalizado)
BUTTON_n_IMAGE      = <IMAGE> (imagen mostrada por los botones 10 a 19)
-----

NOTA: <<paused-motion, PAUSED-MOTION-SPEED>> solo es válido para LinuxCNC versión 2.9 o posterior

.Sección [FILTER]

-----
PROGRAM_EXTENSION = .ngc (filtro archivos *.ngc)
ngc = ./plasmac_gcode.py (analiza el archivo G-Code y comenta cualquier movimiento del eje Z)
-----

[[rs274]]

.Sección [RS274NGC]

-----
RS274NGC_STARTUP_CODE = o<metric_startup> call (código G de inicio de máquina)
SUBROUTINE_PATH = ./:../../nc_files/subroutines (./ debe estar en esta ruta)
FEATURES = 12 (para leer variables .ini y HAL)
USER_M_PATH = ./ (para cambio de material M190)
-----

IMPORTANTE: vea <<path-tolerance, tolerancia de ruta>>

.Sección [HAL]

-----
TWOPASS = on (necesario para múltiples archivos .hal)
HALFILE = <NOMBRE_MÁQUINA>.hal (el archivo .hal de su máquina base)
HALFILE = plasmac.hal (el archivo estándar PlasmaC .hal)
HALFILE = <MACHINE_NAME>_connections.hal (conexiones de PlasmaC a la máquina)
HALFILE = halui (requerido)
-----

El archivo <MACHINE_NAME>.hal tiene 'num_spindles=[TRAJ]SPINDLES' adjunto al final de la línea 'loadrt motmod' para permitir la adición de un << air-scribe, grabador de aire>> si es necesario.

NOTA: Puede colocar comandos HAL personalizados en <NAME_MÁQUINA>_connections.hal ya que este archivo no se sobrescribe con una actualización.

.Sección [TRAJ]

-----
SPINDLES = 3
-----

.Sección [AXIS_X]

-----
MAX_VELOCITY = duplicar el valor en la articulación correspondiente
MAX_ACCELERATION = duplicar el valor en la articulación correspondiente
OFFSET_AV_RATIO = 0.5
-----

.Sección [AXIS_Y]

-----
MAX_VELOCITY = duplicar el valor en la articulación correspondiente
MAX_ACCELERATION = duplicar el valor en la articulación correspondiente
OFFSET_AV_RATIO = 0.5
-----

.Sección [AXIS_Z]

-----
MIN_LIMIT = la parte superior de sus listones o justo debajo
MAX_VELOCITY = duplicar el valor en la articulación correspondiente
MAX_ACCELERATION = duplicar el valor en la articulación correspondiente
OFFSET_AV_RATIO = 0.5
-----

NOTA: PlasmaC utiliza la función de offsets externos para todo el movimiento del eje Z, y para mover los ejes X y/o Y para un cambio de consumible mientras está en pausa, para obtener más información sobre esta función, lea <<cha:external-offsets, Offsets externos de ejes>> en la documentación de Linuxcnc.



=== Específicos para GUI Axis

.Sección [PLASMAC]

-----
FUENTE = sans 11 (los tamaños de fuente válidos son de 10 a 15)
THEME = Clearlooks (cualquier tema instalado)
MAXIMISED = 0 (0 = dimensionado para adaptarse a la fuente, 1 = maximizado)
-----

[[axis-display-section]]

.Sección [DISPLAY]

-----
TOOL_EDITOR = tooledit x y
USER_COMMAND_FILE = plasmac_axis.py.py
EMBED_TAB_NAME    = Statistics
EMBED_TAB_COMMAND = gladevcp -c plasmac_stats -x <XID> -u ./plasmac_stats.py -H ./plasmac_stats.hal plasmac_stats.glade

#use uno de los dos siguientes

# ejecutar recuadro en la pestaña detrás de la vista previa
EMBED_TAB_NAME = Ejecución de Plasma
EMBED_TAB_COMMAND = gladevcp -c plasmac_run -x <XID> -u ./plasmac_run.py -H plasmac_run.hal plasmac_run_tab.glade

# recuadro de ejecución en el panel en el lado izquierdo
#GLADEVCP = -c plasmac_run -u ./plasmac_run.py -H plasmac_run.hal plasmac_run_panel.glade

EMBED_TAB_NAME = Configuración de Plasma
EMBED_TAB_COMMAND = gladevcp -c plasmac_config -x <XID> -u ./plasmac_config.py -H plasmac_config.hal plasmac_config.glade

EMBED_TAB_NAME = Extras
EMBED_TAB_COMMAND = halcmd loadusr -Wn plasmac_wizards gladevcp -c plasmac_wizards -x {XID} -u ./plasmac_wizards.py plasmac_wizards.glade

-----

La ventana Ejecutar se puede mostrar como:

* Un panel en el lado derecho de la GUI Axis que es adecuado para pantallas panorámicas.
* Una pestaña detrás de la pestaña Vista previa que es adecuada para pantallas de relación 4:3.

===Específicos para GUI Gmoccapy

[[gmoccapy-display-section]]

.Sección [DISPLAY]

-----
EMBED_TAB_NAME = plasmac_buttons
EMBED_TAB_LOCATION = box_cooling
EMBED_TAB_COMMAND = gladevcp -c plasmac_buttons -x <XID> -u ./plasmac_buttons.py -H ./plasmac_buttons.hal plasmac_buttons.glade
EMBED_TAB_NAME = plasmac_control
EMBED_TAB_LOCATION = box_spindle
EMBED_TAB_COMMAND = gladevcp -c plasmac_control -x <XID> -u ./plasmac_control.py -H ./plasmac_control.hal plasmac_control.glade
EMBED_TAB_NAME     = Statistics
EMBED_TAB_LOCATION = ntb_preview
EMBED_TAB_COMMAND = gladevcp -c plasmac_stats -x <XID> -u ./plasmac_stats.py -H ./plasmac_stats.hal plasmac_stats.glade
EMBED_TAB_NAME = Ejecución de Plasma

#use uno de los dos siguientes

# panel de ejecución en la pestaña detrás de la vista previa
EMBED_TAB_LOCATION = ntb_preview
EMBED_TAB_COMMAND = gladevcp -c plasmac_run -x <XID> -u ./plasmac_run.py -H plasmac_run.hal plasmac_run_tab.glade

# panel de ejecución en el panel del lado izquierdo
#EMBED_TAB_LOCATION = box_left
#EMBED_TAB_COMMAND = gladevcp -c plasmac_run -x <XID> -u ./plasmac_run.py -H plasmac_run.hal plasmac_run_panel.glade

EMBED_TAB_NAME = Configuración de plasma
EMBED_TAB_LOCATION = ntb_preview
EMBED_TAB_COMMAND = gladevcp -c plasmac_config -x <XID> -u ./plasmac_config.py -H plasmac_config.hal plasmac_config.glade
EMBED_TAB_NAME = plasmac_monitor
EMBED_TAB_LOCATION = box_tool_and_code_info
EMBED_TAB_COMMAND = gladevcp -c plasmac_monitor -x <XID> -u plasmac_monitor.py -H plasmac_monitor.hal plasmac_monitor.glade

EMBED_TAB_NAME = Extras
EMBED_TAB_LOCATION = ntb_preview
EMBED_TAB_COMMAND = halcmd loadusr -Wn plasmac_wizards gladevcp -c plasmac_wizards -x {XID} -u ./plasmac_wizards.py plasmac_wizards.glade

-----

El Panel de Ejecución se puede mostrar como:

* Un panel en el lado izquierdo de la GUI Gmoccapy que es adecuado para pantallas panorámicas.
* Una pestaña detrás de la pestaña Vista previa que es adecuada para pantallas de relación 4: 3.

[[custom-user-buttons]]

== Botones de usuario personalizados

Hay botones disponibles que son programables en el archivo .ini.

Hay cinco botones disponibles en la ventana principal de la GUI Axis, numerados del 1 al 5 de izquierda a derecha.

Hay cuatro botones disponibles en la ventana principal de la GUI Gmoccapy, numerados del 1 al 4 de arriba a abajo.

Hay diez botones adicionales disponibles en el panel Extras, numerados del 10 al 19 desde la parte superior izquierda a la inferior derecha.

Todas las configuraciones de archivo .ini para los botones están en la sección [PLASMAC].

=== Nombres de botones

El texto que aparece en el botón se configura de la siguiente manera:

----
BUTTON_n_NAME = Mostrar HAL
----

Donde n es el número del botón y 'Mostrar HAL' es el texto.

Para el texto en varias líneas en Axis, divida el texto con un \

----
BUTTON_n_NAME = Mostrar\HAL
----

=== Código de botón

Los botones pueden ejecutar <<button-cmds, Comandos externos>>, <<button-code, G-Code>> o cualquiera de las cuatro funciones especiales, <<button-probe, Test sonda>>, <<button-ohmic, Sonda Ohmica>>, <<button-cut, Tipo de corte>> o <<button-consumables, Cambiar consumibles>>. Además de esto, los botones 10 ~ 19 en el panel Extras pueden <<button-load, Cargar>> un programa GCode.

[[botón-cmds]]

.Comandos externos

Para ejecutar un comando externo, el comando está precedido por un carácter %.

----
BUTTON_n_CODE = %halshow
----

[[button-code]]

.Código G

Para ejecutar G-Code, simplemente ingrese el código que se ejecutará.

----
BUTTON_n_CODE = G0 X100
----

Para ejecutar una subrutina existente.

----
BUTTON_n_CODE = o<my_subroutine> call
----

Las variables del archivo .ini se pueden ingresar usando {} (debe poner un espacio después del })

----
BUTTON_n_CODE = G0 X {JOINT_0 HOME} Y1
BUTTON_n_CODE = G53 G0 Z [{AXIS_Z MAX_LIMIT} - 1.001]
----

Se pueden ejecutar múltiples códigos separando los códigos con \

----
BUTTON_n_CODE = G0 X0 Y0 \ G1 X5 \ G1 Y5
----

Los comandos externos y el código G pueden mezclarse en el mismo botón.

----
BUTTON_n_CODE = %halshow \ g0x.5y.5 \ %halmeter
----

[[button-probe]]

.Test de sonda

----
BUTTON_n_CODE = probe-test 30
----

PlasmaC comenzará un sondeo y cuando se detecte la sonda, el eje Z se elevará a la altura de perforación que se muestra actualmente en el panel de ejecución. Luego esperará en este estado durante el tiempo especificado (en este caso, 30 segundos) y luego devolverá el eje Z a la parte superior.

[[button-ohmic]]

.Sonda óhmica

----
BUTTON_n_CODE = ohmic-test
----

PlasmaC activará la sonda óhmica y, si se detecta la sonda óhmica, se iluminará el indicador LED en el panel del monitor. El objetivo principal de esto es permitir una prueba rápida para una punta de antorcha en corto.

[[button-cut]]

.Tipo de corte

----
BUTTON_n_CODE = cut-type
----

Este botón, si está seleccionado, alternará entre los dos <<cut-types, tipos de corte>>.

[[button-consumables]]

.Cambiar consumibles

----
BUTTON_n_CODE = change-consumables X10 Y10 F1000
----

Este botón mueve la antorcha a las coordenadas especificadas cuando la máquina está en pausa para permitir un fácil acceso para cambiar los consumibles.

Las entradas válidas son Xnnn Ynnn Fnnn. F es obligatorio y se requiere al menos uno de X o Y.

Las entradas X e Y están en coordenadas absolutas de la máquina. Si faltan X o Y, se utiliza la coordenada actual para ese eje.

Hay tres métodos para volver a las coordenadas anteriores:

- Presione el botón nuevamente y la antorcha regresará y la máquina esperará un comando de reanudación.
- Reanude el programa que hace que la antorcha regrese y el programa comenzará a ejecutarse.
- Pare el programa que hace que la antorcha regrese, entonces el programa abortará.

[[button-load]]

.Carga

Los botones 10 ~ 19 en el Panel Extras pueden cargar un programa GCode utilizando el siguiente formato.

----
BUTTON_n_CODE = load ruta/a/gcode.ngc
----

La ruta es relativa al directorio especificado por 'PROGRAM_PREFIX' en el archivo .ini. Esto suele ser ~/linuxcnc/nc_files, por lo que si su archivo gcode estaba en un subdirectorio de su directorio 'PROGRAM_PREFIX' llamado 'plasma', la entrada sería 'plasma/gcode.ngc'.

=== Imagen del botón

Los botones 10 ~ 19 en el Panel Extras pueden mostrar una imagen usando el siguiente formato. Si se especifica una imagen, esto tendrá prioridad y la imagen se mostrará en lugar del nombre del botón.

----
BUTTON_n_IMAGE = ruta/a/image.png
----

La ruta es relativa al directorio de configuración, por lo que si su imagen estaba en un subdirectorio de su directorio de configuración llamado 'images', la entrada sería 'images/image.png'.

Todas las imágenes se muestran en un formato de 60 x 60.

[[material-file]]

== Archivo de material

PlasmaC utiliza un archivo que contiene parámetros de corte para materiales. Este archivo se utiliza para <<material-handling, manejo de materiales>>.

El nombre del archivo deriva de '[EMC]MACHINE' en el archivo de entrada, por lo que una máquina llamada 'METRIC_PLASMAC' tendría un archivo de material llamado 'metric_plasmac_material.cfg'.

Las siguientes variables son obligatorias y aparecerá un mensaje de error si no se encuentra ninguna cuando se carga el archivo de material.

* PIERCE_HEIGHT
* PIERCE_DELAY
* CUT_HEIGHT
* CUT_SPEED

Las siguientes variables son opcionales. Si alguna no se detecta o no tiene un valor asignado, se les asignará un valor de 0 y no aparecerá ningún mensaje de error.

* NAME
* KERF_WIDTH
* THC
* PUDDLE_JUMP_HEIGHT
* PUDDLE_JUMP_DELAY
* CUT_AMPS
* CUT_VOLTS

ADVERTENCIA: Es responsabilidad del operador asegurarse de que se incluyan las variables si son un requisito para que se ejecute el G-Code.

El archivo de material utiliza el siguiente formato:

----
[MATERIAL_NUMBER_1]
NAME = nombre
KERF_WIDTH = valor
THC = valor (0 = apagado, 1 = encendido)
PIERCE_HEIGHT = valor
PIERCE_DELAY = valor
PUDDLE_JUMP_HEIGHT = valor
PUDDLE_JUMP_DELAY = valor
CUT_HEIGHT = valor
CUT_SPEED = valor
CUT_AMPS = valor (solo se usa para información del operador)
CUT_VOLTS = valor (solo modos 0 y 1. Si no, usa muestreo automático de voltaje)
----

El archivo de material es un archivo de texto sin formato y puede editarse con cualquier editor de texto.

Es posible editar el archivo de material mientras LinuxCNC se está ejecutando haciendo clic en 'Recargar' en el Panel de ejecución después de que se hayan guardado los cambios.

== Configuraciones de ejemplo

Hay archivos de configuración de ejemplo para las GUI Axis y Gmoccapy que utilizan el componente PlasmaC HAL para simular máquinas de corte por plasma.

* metric_plasmac.ini
* imperial_plasmac.ini

Los archivos en las configuraciones de ejemplo son:
[width="100%",cols="1,2"]
|===
|*Nombre de archivo*|*Función*
|<MACHINE>.ini|archivo de configuración
|<MACHINE>.hal|Conexiones HAL para el componente PlasmaC
|<MACHINE>_connections.hal|Conexiones HAL a los pines HAL de E / S
|plasmac.tcl|conexiones HAL permanentes para el componente plasmac
|plasmac_xxx.glade|un panel gladevcp que se conecta al componente PlasmaC
|plasmac_xxx.hal|Conexiones HAL para el panel
|plasmac_xxx.py|código python para el panel
|xxx_startup.ngc|comandos de inicio del código G
|plasmac_gcode.py|elimina los movimientos del eje z del archivo G-Code abierto
|plasmac_axis.py|código Python para personalizar la GUI Axis
|M190|para el cambio de materiales del código G
|materialverter.py|convertidor de tabla de herramientas y creador de archivos de material
|configurator.py|actualice una configuración existente o configure una nueva de PlasmaC 
|===

El configurador crea los siguientes archivos:
[width="100%",cols="1,2"]
|===
|*Nombre de archivo*|*Función* (<MACHINE> = nombre de la máquina en el archivo .ini)
|<MACHINE> .ini|su nuevo archivo .ini
|<MACHINE> .hal|su nuevo archivo .hal
|<MACHINE>_connections.hal|Conexiones HAL a sus pines HAL de E / S
|plasmac.tcl|conexiones HAL permanentes para el componente plasmac
|===

Después de ejecutar una nueva configuración de trabajo la primera vez, se creará lo siguiente:
[width="100%",cols="1,2"]
|===
|*Nombre de archivo*|*Función* (<MÁQUINA> = nombre de la máquina en el archivo .ini)
|<MÁQUINA>_config.cfg|ajustes de configuración para la pestaña de configuración
|<MÁQUINA>_run.cfg|ajustes de configuración para el Panel de ejecución
|<MÁQUINA>_material.cfg|archivo de material para parámetros de corte
|plasmac_stats.var|estadísticas guardadas
|===

NOTA: Los comandos personalizados están permitidos en <MACHINE>_connections.hal ya que no se sobrescribe durante las actualizaciones

NOTA: Los archivos .ini tienen notacion extra para los requisitos adicionales para estas configuraciones.

NOTA: Los archivos .cfg son texto sin formato y pueden editarse con cualquier editor de texto.

== Ejemplos de NGC

Hay algunos archivos de código G de ejemplo en nc_files/plasmac.

== Panel de Test

Hay un directorio ./test en las fuentes que tiene un Panel de prueba simple y un archivo python asociado que se puede usar para probar la configuración de ejemplo como se referencia en el archivo .ini.

Si desea utilizar esto en su propia configuración sim, deberá crear un enlace a este directorio y editar su archivo .ini para adaptarlo.

== Actualizar una configuración existente de LinuxCNC

El método de actualización depende del tipo de instalación de LinuxCNC:

=== Actualizar una instalación de LinuxCNC Buildbot

Desde una terminal:

----
$ sudo apt-get update
$ sudo apt-get dist-upgrade
----

=== Actualizar una instalación LinuxCNC Run In Place

Desde una terminal:

----
$ cd ~ / linuxcnc-dev
$ git pull
$ cd src
$ make
$ sudo make setuid
----

=== Cambiar tipo de instalación de LinuxCNC

Es posible cambiar el tipo de instalación de LinuxCNC:

* Si actualmente tiene una instalación rip y desea cambiar a una instalación de buildbot, entonces haga una <<buildbot-install, instalación de buildbot>>.
* Si actualmente tiene una instalación buildbot en funcionamiento y desea cambiar a una instalación RIP, entonces haga una <<rip-install, instalación RIP>>.

IMPORTANTE: Si se realizó alguno de estos pasos, se recomienda que actualice su configuración de PlasmaC

== Actualizar una configuración de PlasmaC existente

Se recomienda realizar una actualización de Plasmac después de cada actualización de LinuxCNC aunque no siempre sea necesario. Esto asegurará que la versión de configuración de PlasmaC coincida con la versión actual de LinuxCNC.

NOTA: Debe haber actualizado su instalación de LinuxCNC antes de actualizar la configuración de PlasmaC.

La actualización de una configuración de Plasmac se realiza desde el Configurador que se encuentra en su directorio de configuración.

Para iniciar el configurador, abra una terminal e ingrese:

====
$ python linuxcnc/<su_directorio_configuration>/configurator.py
====

La ventana de selección ahora es visible:

image::images/plasmac_configurator_home_used.png[width=300]

Seleccione 'Actualizar' en la ventana de selección, esto muestra un cuadro de diálogo de información, seleccione 'Continuar' y se mostrará la ventana Actualizar.

image::images/plasmac_configurator_upgrade.png[width=400]

Seleccione el archivo .ini de la configuración de PlasmaC que desea actualizar, haga clic en 'Actualizar' y se actualizará su configuración de PlasmaC.

[[modify-config]]

== Reconfigurar una configuración de PlasmaC existente

El configurador puede modificar:

* Los pines HAL que conectan PlasmaC a la máquina.
* El modo utilizado por PlasmaC.
* La posición del Panel de ejecución en la GUI.

La reconfiguración de una configuración de Plasmac se realiza desde el Configurador que se encuentra en su directorio de configuración.

Para iniciar el configurador, abra una terminal e ingrese:

====
$ python linuxcnc/<su_directorio_configuration>/configurator.py
====

La ventana de selección ahora es visible:

image::images/plasmac_configurator_home_used.png[width=300]

Seleccione 'Reconfigurar' en la ventana de selección, esto muestra un diálogo de información, seleccione 'Continuar' y se mostrará la ventana Reconfigurar.

image::images/plasmac_configurator_reconfigure.png[width=400]

Seleccione el archivo .ini de la configuración de PlasmaC que desea reconfigurar.

Si cambia de modo, notará que los cuadros de entrada cambian según el modo seleccionado actualmente.

Cuando todas las entradas sean correctas, haga clic en 'Reconfigurar' y su configuración de PlasmaC se reconfigurará.

Se pueden encontrar descripciones de entradas <<configurator-table, aquí>>

NOTA: El nombre de la máquina y el archivo .hal no se pueden modificar.

== Materialverter

Esta aplicación se utiliza para convertir tablas de herramientas existentes en archivos de material PlasmaC, también puede crear un archivo de material desde la entrada manual del usuario a los campos de entrada.

En esta etapa, las únicas conversiones disponibles son de SheetCam y Fusion360.

Las tablas de herramientas de Sheetcam están completas y la conversión es completamente automática.

Las tablas de herramientas de Fusion360 no tienen todos los campos obligatorios, por lo que se le solicita al usuario los parámetros faltantes.

Si tiene un formato que desea convertir, haga una solicitud en https://forum.linuxcnc.org/plasma-laser/35449-another-plasma-component[this LinuxCNC forum thread]:

Materialverter puede ejecutarse desde un administrador de archivos GUI haciendo doble clic en 'materialverter.py' en su directorio de configuración o puede ejecutarse desde un terminal con el siguiente comando:

----
$ python ~/linuxcnc/configs/<nombre de máquina>/materialverter.py
----

Aparecerá el cuadro de diálogo del convertidor de material:

image::images/plasmac_material_main.png[width=400]

Seleccione uno de:

* Manual: para crear manualmente un nuevo archivo de material.
* SheetCam: para convertir un archivo de herramienta SheetCam.
* Fusion360: para convertir un archivo de herramienta Fusion360.

Solo para SheetCam, seleccione si desea un archivo de salida métrico o imperial.

Para una conversión, seleccione el archivo de entrada que desea convertir.

Seleccione el archivo de salida en el que desea escribir, esto normalmente sería ~/linuxcnc/configs/<machine-name>_material.cfg, aunque puede seleccionar un archivo diferente y editar manualmente su <machine-name>_material.cfg.

Haga clic en Crear/Convertir y se creará su nuevo archivo de material.

Para una creación manual o una conversión de Fusion360, aparecerá un cuadro de diálogo y cualquier entrada marcada con pass:[***] es obligatoria y todas las demás entradas son opcionales dependiendo de su configuración.

con cualquier parámetro requerido mostrado para la entrada.

image::images/plasmac_material_dialogs.png[width=300]

NOTA: Si selecciona ~/linuxcnc/configs/<machine-name>_material.cfg, si este archivo ya existe, se sobrescribirá.

[[mesa-thcad]]

== Mesa THCAD

Las configuraciones de jumper preferidas son 'UNIPOLAR' y 'F/32'

Deberá agregar manualmente una escala y un modo de contador al archivo .hal de la máquina base antes de ejecutar el Configurador.

Si conectó su THCAD a una Mesa 7i76e, los comandos requeridos en el archivo .hal serían:

----
setp hm2_7i76e.0.encoder.00.scale -1
setp hm2_7i76e.0.encoder.00.counter-mode 1
----

Luego debe tener en cuenta que el 'pin HAL de voltaje de arco' necesario para ingresar en el Configurador PlasmaC será:

----
hm2_7i76e.0.encoder.00.velocity
----

=== Obtención de la relación divisoria

.Uso de un puerto CNC en la fuente de alimentación de plasma

La relación del divisor es igual a la relación del divisor interno seleccionado.

.THCAD-10

Una configuración común es una resistencia de 1 megOhm de negativo arco a negativo THCAD y una resistencia de 1 megOhm de arco positivo a THCAD positivo. Esto proporciona una lectura a escala completa de 210V. El THCAD puede manejar sobretensiones de hasta 500V, por lo que esto no es un problema.

IMPORTANTE: Si está utilizando una fuente de alimentación de plasma de inicio HF, cada una de estas resistencias debe estar compuesta por varias resistencias de alto voltaje.

Para obtener la relación del divisor, use (R1 + R2 + 100000) / 100000, por lo que para lo anterior sería (1000000 + 1000000 +100000) / 100000 dando una relación de 21.

.THCAD-300

Relación divisoria = 29

=== Valores de calibración

Esto es para obtener los valores iniciales para la compensación de voltaje y la escala de voltaje en la pestaña Configuración.

Si observa la parte posterior del THCAD, verá una etiqueta de calibración con:

----
0V 121.1 kHz
10V 925.3 kHz
----

O valores similares, estas son las frecuencias generadas por el THCAD para 0 voltios y 10 voltios respectivamente.

Para nuestros cálculos, usaremos 32 de la configuración de puente 'F/32' y 10, que es la lectura a escala completa de la propia tarjeta THCAD.

.Escala de voltaje

Use la fórmula:

----
Divider_Ratio/((10V_frequency-0V_frequency)/32/10)
----

Este resultado se utilizará para configurar 'Escala de voltaje' en la pestaña Configuración al configurar la configuración.

El ejemplo anterior de THCAD-10 sería:

----
21/((925300-121100)/32/10) = 0,00835613
----

.Offset de voltaje

Usa la fórmula:

----
0V_frequency/32
----

Este resultado se utilizará para configurar 'Offset de voltaje' en la pestaña Configuración.

El ejemplo anterior de THCAD-10 sería:

----
121100/32 = 3784.375
----

=== Configuración de la tarjeta Mesa

Cuando se utiliza un THCAD conectado a un codificador en una placa Mesa Electronics, p. 7i96, entonces es necesario configurar el codificador en modo arriba/abajo en el archivo .hal y se recomienda configurar el canal B del codificador (si existe) en modo single ended (TTL) configurando los puentes en la placa. Consulte el manual de su placa para obtener más información.

La configuración en el archivo .hal sería similar a:

----
setp hm2_7i96.0.encoder.00.counter-mode 1
setp hm2_7i96.0.encoder.00.filter 1
setp hm2_7i96.0.encoder.00.scale -1
----

NOTA: Hay un <<lowpass, filtro de paso bajo>> disponible que puede ser útil si utiliza un THCAD.


